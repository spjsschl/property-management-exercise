version: 2

models:
  - name: stg_leases
    description: "One unique row per lease"
    columns:
      - name: lease_id
        description: "Primary key"
        tests:
          - unique
          - not_null
      - name: unit_id
        tests:     
        - relationships:
            to: ref('stg_units')
            field: unit_id
      - name: rental_application_id
        tests:
        - relationships:
            to: ref('stg_rental_applications')
            field: rental_application_id
      - name: completed
        tests:
        - accepted_values:
           values:
             - true
             - false
  - name: stg_properties
    columns:
      - name: property_id
        description: "Primary key"
        tests:
          - unique
          - not_null
      - name: type
        description: "One of commercial, homeowners_association, multi_family_residence, single_family_residence"
        tests:
          - accepted_values:
              values:
                - commercial
                - homeowners_association
                - multi_family_residence
                - single_family_residence
      - name: name
        tests:
          - not_null
  - name: stg_rental_applications
    columns:
      - name: rental_application_id
        description: "Primary key"
        tests:
          - unique
          - not_null
      - name: status
        tests:
        - accepted_values:
           values:
             - denied
             - approved
             - converted_to_tenant
  - name: stg_units
    columns:
      - name: property_id
        tests:     
        - relationships:
            to: ref('stg_properties')
            field: property_id
      - name: status
        description: "{{ doc('unit_status') }}"
        tests:
          - accepted_values:
              values:
                - occupied
                - rented
                - vacant
                - construction
      
      

